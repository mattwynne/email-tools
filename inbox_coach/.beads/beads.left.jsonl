{"id":"inbox_coach-0u4","content_hash":"0585ecef50d5d8b52be3a429ab9856c065a13697410c4106037918e840734413","title":"EventsLive crashes on mount when get_account_pid returns nil","description":"EventsLive crashes at line 19 when FastmailAccounts.get_account_pid(current_user.id) returns nil, causing GenServer.call(nil, :get_state) to fail. This causes a crash loop where the LiveView repeatedly crashes and restarts, making email details disappear.","status":"closed","priority":1,"issue_type":"bug","created_at":"2025-11-15T00:27:43.086086-08:00","updated_at":"2025-11-15T12:39:04.11598-08:00","closed_at":"2025-11-15T12:39:04.11598-08:00","source_repo":".","comments":[{"id":1,"issue_id":"inbox_coach-0u4","author":"matt","text":"Files involved:\n- lib/inbox_coach_web/events_live.ex (crash site at line 19)\n- lib/inbox_coach/fastmail_accounts.ex (manages account processes)\n- lib/inbox_coach/fastmail_account.ex (the GenServer that should be running)\n\nError details:\n** (stop) exited in: GenServer.call(nil, :get_state, 5000)\n    ** (EXIT) no process: the process is not alive or there's no process currently associated with the given name\n\nRoot cause: get_account_pid returns nil instead of a PID when the FastmailAccount process isn't running for the user.","created_at":"2025-11-15T08:27:54Z"}]}
{"id":"inbox_coach-524","content_hash":"6f552bd2850a18b33e529366e811377948348c4d596ed7456cb0828af17fefdb","title":"Update contacts when email added to mailbox","description":"","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-11T08:05:51.865758-08:00","updated_at":"2025-11-11T08:05:51.865758-08:00","source_repo":"."}
{"id":"inbox_coach-5pa","content_hash":"f107babbbaa412b16e59907f66d6b95ddb8e5d30f6538252270feb5c1203e9b0","title":"Stream events to browser","description":"","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-11T08:06:29.109454-08:00","updated_at":"2025-11-11T08:06:29.109454-08:00","source_repo":"."}
{"id":"inbox_coach-dmg","content_hash":"eb5e2fef7a6ee28943efae51e998c592c94e020dfc8f7b5107b3e2b8e69341b4","title":"Add mailbox selection and email filtering to root_live","description":"","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2025-11-08T23:25:18.593806-08:00","updated_at":"2025-11-08T23:25:35.986455-08:00","source_repo":"."}
{"id":"inbox_coach-ots","content_hash":"5323b4362548b4b4af00e92c2cc162b6ceeaa12b594eb543f2a9c8c63f1e5610","title":"Display emails with infinite scroll using Phoenix LiveView Streams","description":"Implement email list display using Phoenix LiveView Streams to handle potentially large email collections efficiently.\n\n## Context\n\nCurrently, the app shows email counts but not the actual emails. We need to display emails, but there could be too many to render at once.\n\n## Phoenix LiveView Options\n\n### 1. LiveView Streams (v0.18+)\nStreams are designed for large collections:\n- Keep items on client (not server memory)\n- Efficiently handle inserts, updates, deletes\n- Work with limits for rolling window\n\nBasic pattern:\n```elixir\ndef mount(_params, _session, socket) do\n  {:ok, socket |\u003e stream(:emails, list_emails(page: 1, per_page: 50))}\nend\n```\n\nTemplate uses phx-update=\"stream\":\n```heex\n\u003cdiv id=\"emails\" phx-update=\"stream\"\u003e\n  \u003cdiv :for={{dom_id, email} \u003c- @streams.emails} id={dom_id}\u003e\n    \u003c%= email.subject %\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\n### 2. Infinite Scroll with phx-viewport-bottom (v0.19+)\nBuilt-in scroll detection - no JavaScript needed:\n```heex\n\u003cdiv id=\"emails\" phx-update=\"stream\" \n     phx-viewport-bottom={!@end_of_emails? \u0026\u0026 \"load-more\"}\n     class=\"overflow-y-auto h-screen\"\u003e\n  \u003cdiv :for={{dom_id, email} \u003c- @streams.emails} id={dom_id}\u003e\n    \u003c%= email.subject %\u003e\n  \u003c/div\u003e\n\u003c/div\u003e\n```\n\nEvent handler:\n```elixir\ndef handle_event(\"load-more\", _params, socket) do\n  page = socket.assigns.page + 1\n  emails = list_emails(page: page, per_page: 50)\n  \n  {:noreply,\n   socket\n   |\u003e stream(:emails, emails, at: -1)  # -1 = append\n   |\u003e assign(:page, page)\n   |\u003e assign(:end_of_emails?, emails == [])}\nend\n```\n\n### 3. Limited Streams (Rolling Window)\nOnly keep most recent N items visible:\n```elixir\nstream(:emails, list_recent_emails(), limit: 100)  # Only keep 100 in DOM\n```\n\nThe :limit option automatically removes old items as new ones arrive.\n\n### 4. Bidirectional Scroll\nFor scrolling up for history:\n```heex\n\u003cdiv phx-update=\"stream\"\n     phx-viewport-top=\"load-previous\"\n     phx-viewport-bottom=\"load-more\"\u003e\n  \u003c!-- emails here --\u003e\n\u003c/div\u003e\n```\n\n## Recommended Approach\n\nFor email list in inbox coach:\n1. Start with streams + phx-viewport-bottom for infinite scroll\n2. Add :limit if performance issues with thousands of emails\n3. Show subset initially (e.g., last 100 emails), let users load more\n\n## Resources\n\n- hexdocs.pm/phoenix_live_view - streams documentation\n- yellowduck.be scroll events guide\n- Flop Phoenix for ready-made components\n- GitHub: ChristianAlexander/liveview_bidirectional_scroll_demo","status":"in_progress","priority":1,"issue_type":"feature","created_at":"2025-11-11T00:20:30.228784-08:00","updated_at":"2025-11-15T13:41:13.540221-08:00","source_repo":".","dependencies":[{"issue_id":"inbox_coach-ots","depends_on_id":"inbox_coach-s0t","type":"blocks","created_at":"2025-11-11T08:08:22.403848-08:00","created_by":"daemon"}]}
{"id":"inbox_coach-s0t","content_hash":"e44396e55c3ee90291e9c4e04a097bb5c7ae972ad525baaabbb4b21a01a7b1e2","title":"Collect and show stats","description":"","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-08T08:35:52.39927-08:00","updated_at":"2025-11-08T08:35:52.39927-08:00","source_repo":"."}
{"id":"inbox_coach-tni","content_hash":"1097154fb32238bc94379464d97122bb76f10b69556538b867f5222544bec78c","title":"Show live count of messages outside of archive and junk","description":"","status":"open","priority":2,"issue_type":"feature","created_at":"2025-11-08T08:36:31.771224-08:00","updated_at":"2025-11-08T08:36:31.771224-08:00","source_repo":".","dependencies":[{"issue_id":"inbox_coach-tni","depends_on_id":"inbox_coach-s0t","type":"parent-child","created_at":"2025-11-08T08:36:31.772208-08:00","created_by":"daemon"}]}
